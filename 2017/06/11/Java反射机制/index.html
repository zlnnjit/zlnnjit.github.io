<!DOCTYPE html>
<html>
<head hexo-theme='https://volantis.js.org/#2020'>
  <meta charset="utf-8">
  <!-- SEO相关 -->
  
    
  
  <!-- 渲染优化 -->
  <meta name="renderer" content="webkit">
  <meta name="force-rendering" content="webkit">
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
  <meta name="HandheldFriendly" content="True" >
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  <!-- 页面元数据 -->
  
    <title>Java反射机制 - zln&#39;s blog</title>
  
    <meta name="keywords" content="javase,AOP,反射,动态代理,javase 高级特性">
  
  
    <meta name="description" content="Java 反射概述 Reflection（反射）是被视为动态语言的关键，反射机制允许程序在执行期借助于Reflection API取得任何类的内部信息，并能直接操作任意对象的内部属性及方法">
  

  <!-- feed -->
  

  <!-- import meta -->
  

  <!-- link -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.12.1/css/all.min.css">
  
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css">

  
  
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-waves@0.7.6/dist/waves.min.css">

  

  

  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer@1.10/dist/APlayer.min.css">
  

  <!-- import link -->
  

  
    
<link rel="stylesheet" href="/css/style.css">

  

  <script>
    function setLoadingBarProgress(num) {
      document.getElementById('loading-bar').style.width=num+"%";
    }
  </script>

  
  
</head>

<body>
  
  <div class="cover-wrapper">
    
      <cover class='cover post half'>
        <div class='cover-body'>
  <div class='a'>
    
    
      <p class="title">bcoder.top</p>
    
    
      <p class="subtitle">不忘初心，无畏前行</p>
    
  </div>
  <div class='b'>
    
      <div class="m_search">
        <form name="searchform" class="form u-search-form">
          <input type="text" class="input u-search-input" placeholder="" />
          <i class="icon fas fa-search fa-fw"></i>
        </form>
      </div>
    
    <div class='menu navigation'>
      <ul class='h-list'>
        
          
            <li>
              <a class="nav home"
                href="/"
                
                
                id="home">
                <i class='fas fa-rss fa-fw'></i>&nbsp;博客
              </a>
            </li>
          
            <li>
              <a class="nav home"
                href="/categories/"
                
                
                id="categories">
                <i class='fas fa-folder-open fa-fw'></i>&nbsp;分类
              </a>
            </li>
          
            <li>
              <a class="nav home"
                href="/tags/"
                
                
                id="tags">
                <i class='fas fa-tags fa-fw'></i>&nbsp;标签
              </a>
            </li>
          
            <li>
              <a class="nav home"
                href="/archives/"
                
                
                id="archives">
                <i class='fas fa-archive fa-fw'></i>&nbsp;归档
              </a>
            </li>
          
            <li>
              <a class="nav home"
                href="https://github.com/zlnnjit"
                
                
                  target="_blank"
                
                id="https:githubcomzlnnjit">
                <i class='fas fa-link fa-fw'></i>&nbsp;github
              </a>
            </li>
          
            <li>
              <a class="nav home"
                href="/about/"
                
                
                id="about">
                <i class='fas fa-info-circle fa-fw'></i>&nbsp;关于
              </a>
            </li>
          
        
      </ul>
    </div>
  </div>
</div>

      </cover>
    
    <div id="loading-bar-wrapper">
  <div id="loading-bar"></div>
</div>
<header class="l_header shadow blur">

  <div class='wrapper'>
    <div class='nav-sub container--flex'>
      <a class="logo flat-box"></a>
      <ul class='switcher h-list'>
        <li><a class="s-comment flat-btn fas fa-comments fa-fw" target="_self" href='javascript:void(0)'></a></li>
        
          <li><a class="s-toc flat-btn fas fa-list fa-fw" target="_self" href='javascript:void(0)'></a></li>
        
      </ul>
    </div>
		<div class="nav-main container container--flex">
      
        
        <a class="logo flat-box" target="_self" href='/'>
          
          
          
          
            周陆宁 <b><sup style='color:#3AA757'>2020</sup></b>
          
        </a>
      

			<div class='menu navigation'>
				<ul class='h-list'>
          
          
          
            
            
              <li>
                <a class="flat-box" href=/
                  
                  
                  
                    id="home"
                  >
                  
                    <i class='fas fa-rss fa-fw'></i>
                  
                  博客
                </a>
                
              </li>
            
          
          
            
            
              <li>
                <a class="flat-box" href=/categories/
                  
                  
                  
                    id="categories"
                  >
                  
                    <i class='fas fa-folder-open fa-fw'></i>
                  
                  分类
                </a>
                
              </li>
            
          
          
            
            
              <li>
                <a class="flat-box" href=/tags/
                  
                  
                  
                    id="tags"
                  >
                  
                    <i class='fas fa-tags fa-fw'></i>
                  
                  标签
                </a>
                
              </li>
            
          
          
            
            
              <li>
                <a class="flat-box" href=/archives/
                  
                  
                  
                    id="archives"
                  >
                  
                    <i class='fas fa-archive fa-fw'></i>
                  
                  归档
                </a>
                
              </li>
            
          
          
            
            
              <li>
                <a class="flat-box" href=https://github.com/zlnnjit
                  
                  
                    target="_blank"
                  
                  
                    id="https:githubcomzlnnjit"
                  >
                  
                    <i class='fas fa-link fa-fw'></i>
                  
                  github
                </a>
                
              </li>
            
          
          
            
            
              <li>
                <a class="flat-box" href=/about/
                  
                  
                  
                    id="about"
                  >
                  
                    <i class='fas fa-info-circle fa-fw'></i>
                  
                  关于
                </a>
                
              </li>
            
          
          
				</ul>
			</div>

      
        <div class="m_search">
          <form name="searchform" class="form u-search-form">
            <i class="icon fas fa-search fa-fw"></i>
            <input type="text" class="input u-search-input" placeholder="搜索" />
          </form>
        </div>
      

			<ul class='switcher h-list'>
				
					<li><a class="s-search flat-btn fas fa-search fa-fw" target="_self" href='javascript:void(0)'></a></li>
				
				<li><a class="s-menu flat-btn fas fa-bars fa-fw" target="_self" href='javascript:void(0)'></a></li>
			</ul>
		</div>
	</div>
</header>
<ul class="menu-phone navigation white-box">
  
  
    <li>
      <a class="flat-box" href=/
        
        
        
          id="home"
        >
        
          <i class='fas fa-rss fa-fw'></i>
        
        博客
      </a>
    </li>
  
    <li>
      <a class="flat-box" href=/categories/
        
        
        
          id="categories"
        >
        
          <i class='fas fa-folder-open fa-fw'></i>
        
        分类
      </a>
    </li>
  
    <li>
      <a class="flat-box" href=/tags/
        
        
        
          id="tags"
        >
        
          <i class='fas fa-tags fa-fw'></i>
        
        标签
      </a>
    </li>
  
    <li>
      <a class="flat-box" href=/archives/
        
        
        
          id="archives"
        >
        
          <i class='fas fa-archive fa-fw'></i>
        
        归档
      </a>
    </li>
  
    <li>
      <a class="flat-box" href=https://github.com/zlnnjit
        
        
        
          id="https:githubcomzlnnjit"
        >
        
          <i class='fas fa-link fa-fw'></i>
        
        github
      </a>
    </li>
  
    <li>
      <a class="flat-box" href=/about/
        
        
        
          id="about"
        >
        
          <i class='fas fa-info-circle fa-fw'></i>
        
        关于
      </a>
    </li>
  
</ul>
<script>setLoadingBarProgress(40);</script>

  </div>


  <div class="l_body">
    <div class='body-wrapper'>
      

<div class='l_main'>
  

  
    <article id="post" class="post white-box shadow article-type-post" itemscope itemprop="blogPost">
      


  <section class='meta'>
    
    
    <div class="meta" id="header-meta">
      
        
  
    <h1 class="title">
      <a href="/2017/06/11/Java%E5%8F%8D%E5%B0%84%E6%9C%BA%E5%88%B6/">
        Java反射机制
      </a>
    </h1>
  


      
      <div class='new-meta-box'>
        
          
        
          
            
<div class='new-meta-item author'>
  <a href="" rel="nofollow">
    <img src="https://cdn.jsdelivr.net/gh/xaoxuu/cdn-assets/avatar/avatar.png">
    <p>周陆宁</p>
  </a>
</div>

          
        
          
            
  
  <div class='new-meta-item category'>
    <a href='/categories/java/' rel="nofollow">
      <i class="fas fa-folder-open fa-fw" aria-hidden="true"></i>
      <p>java</p>
    </a>
  </div>


          
        
          
            <div class="new-meta-item date">
  <a class='notlink'>
    <i class="fas fa-calendar-alt fa-fw" aria-hidden="true"></i>
    <p>发布于：2017-06-11 09:21:35</p>
  </a>
</div>

          
        
          
            
  <div class="new-meta-item wordcount">
    <a class='notlink'>
      <i class="fas fa-keyboard fa-fw" aria-hidden="true"></i>
      <p>字数：6.8k</p>
    </a>
  </div>
  <div class="new-meta-item readtime">
    <a class='notlink'>
      <i class="fas fa-hourglass-half fa-fw" aria-hidden="true"></i>
      <p>时长：30 分钟</p>
    </a>
  </div>


          
        
          
            

          
        
      </div>
      
        <hr>
      
    </div>
  </section>


      <section class="article typo">
        <div class="article-entry" itemprop="articleBody">
          
          <h2 id="Java-反射概述"><a href="#Java-反射概述" class="headerlink" title="Java 反射概述"></a>Java 反射概述</h2><p> Reflection（反射）是被视为<strong>动态语言</strong>的关键，反射机制允许程序在执行期借助于Reflection API取得<strong>任何类</strong>的内部信息，并能直接操作任意对象的内部属性及方法</p>
<a id="more"></a>
<p>Java反射机制提供的功能</p>
<ul>
<li>在运行时判断任意一个对象所属的类</li>
<li>在运行时构造任意一个类的对象</li>
<li>在运行时判断任意一个类所具有的成员变量和方法</li>
<li>在运行时调用任意一个对象的成员变量和方法</li>
<li>生成动态代理</li>
</ul>
<p>反射相关的主要API：</p>
<ul>
<li>java.lang.Class:代表一个类</li>
<li>java.lang.reflect.Method:代表类的方法</li>
<li>java.lang.reflect.Field:代表类的成员变量</li>
<li>java.lang.reflect.Constructor:代表类的构造方法</li>
<li>……</li>
</ul>
<h2 id="Class-类"><a href="#Class-类" class="headerlink" title="Class 类"></a>Class 类</h2><h3 id="Class类概述"><a href="#Class类概述" class="headerlink" title="Class类概述"></a>Class类概述</h3><p>在Object类中定义了以下的方法，此方法将被所有子类继承：<br><code>public final Class getClass()</code></p>
<p>以上的方法返回值的类型是一个Class类，此类是Java反射的源头，实际上所谓反射从程序的运行结果来看也很好理解，即：可以通过对象反射求出类的名称。</p>
<p><img src="http://img.bcoder.top/2017.06.11/1.png" alt="Java反射机制"></p>
<p>反射后可以得到的信息：某个类的属性、方法和构造器、某个类到底实现了哪些接口。对于每个类而言，JRE 都为其保留一个不变的 Class 类型的对象。一个 Class 对象包含了特定某个类的有关信息。</p>
<p>我们需要知道：</p>
<ul>
<li>Class本身也是一个类</li>
<li>Class 对象只能由系统建立对象</li>
<li>一个类在 JVM 中只会有一个Class实例 </li>
<li>一个Class对象对应的是一个加载到JVM中的一个.class文件</li>
<li>每个类的实例都会记得自己是由哪个 Class 实例所生成</li>
<li>通过Class可以完整地得到一个类中的完整结构 </li>
</ul>
<p>Class的实例生成过程：<br>我们创建了一个类，通过编译（javac.exe）,生成对应的.class文件。之后我们使用java.exe加载（JVM的类加载器完成的） 此.class文件，此.class文件加载到内存以后，就是一个运行时类，存在在缓存区。那么这个运行时类本身就是一个Class的实例<br>1.每一个运行时类只加载一次！<br>2.有了Class的实例以后，我们才可以进行如下的操作：</p>
<ul>
<li>1）创建对应的运行时类的对象</li>
<li>2）获取对应的运行时类的完整结构（属性、方法、构造器、内部类、父类、所在的包、异常、注解、…）</li>
<li>3）调用对应的运行时类的指定的结构(属性、方法、构造器)</li>
<li>4）反射的应用：动态代理<h3 id="Class类的常用方法"><a href="#Class类的常用方法" class="headerlink" title="Class类的常用方法"></a>Class类的常用方法</h3></li>
</ul>
<p><img src="http://img.bcoder.top/2017.06.11/2.png" alt="Java反射机制"></p>
<p>Demo：</p>
<p>首先创建一个实体类供我们实验使用：<br>Person.java</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Person</span> </span>&#123;</span><br><span class="line">	<span class="keyword">private</span> String name;</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">int</span> age;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">Person</span><span class="params">()</span> </span>&#123;&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">Person</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">super</span>();</span><br><span class="line">		<span class="keyword">this</span>.name = name;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">Person</span><span class="params">(String name, <span class="keyword">int</span> age)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">super</span>();</span><br><span class="line">		<span class="keyword">this</span>.name = name;</span><br><span class="line">		<span class="keyword">this</span>.age = age;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> name;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.name = name;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getAge</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> age;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setAge</span><span class="params">(<span class="keyword">int</span> age)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.age = age;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">show</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		System.out.println(<span class="string">"Person show"</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">display</span><span class="params">(String str)</span> </span>&#123;</span><br><span class="line">		System.out.println(<span class="string">"Person display"</span>+str);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="string">"Person [name="</span> + name + <span class="string">", age="</span> + age + <span class="string">"]"</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>demo1:在有反射以前，创建一个类的对象，并调用其中的方法、属性</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">demo1</span><span class="params">()</span></span>&#123;</span><br><span class="line">	Person p = <span class="keyword">new</span> Person();</span><br><span class="line">	p.setAge(<span class="number">10</span>);</span><br><span class="line">	p.setName(<span class="string">"zhangsan"</span>);</span><br><span class="line">	System.out.println(p);</span><br><span class="line">	p.show();</span><br><span class="line">	p.display(<span class="string">"hello"</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<p>输出结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Person [name&#x3D;zhangsan, age&#x3D;10]</span><br><span class="line">Person show</span><br><span class="line">Person display:hello</span><br></pre></td></tr></table></figure>


<p>demo2:通过反射创建一个类的对象，并调用其中的结构</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">demo2</span><span class="params">()</span> <span class="keyword">throws</span> Exception</span>&#123;</span><br><span class="line">	Class&lt;Person&gt; clazz = Person<span class="class">.<span class="keyword">class</span></span>;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">//1.创建clazz对应的运行时类的Person对象</span></span><br><span class="line">	Person p = clazz.newInstance();<span class="comment">//不使用泛型需要强转</span></span><br><span class="line">	System.out.println(p);</span><br><span class="line">	</span><br><span class="line">	<span class="comment">//2.获取person属性</span></span><br><span class="line">	<span class="comment">//由于name属性private（protected也不行），所以这样获取会报错</span></span><br><span class="line">	<span class="comment">/*Field f1 = clazz.getField("name");</span></span><br><span class="line"><span class="comment">	f1.set(p,"lisi");</span></span><br><span class="line"><span class="comment">	System.out.println(p);*/</span></span><br><span class="line">	</span><br><span class="line">	<span class="comment">//解决办法：调用声明的方法(适合所有的作用域)</span></span><br><span class="line">	Field f1 = clazz.getDeclaredField(<span class="string">"name"</span>);</span><br><span class="line">	f1.setAccessible(<span class="keyword">true</span>);</span><br><span class="line">	f1.set(p,<span class="string">"lisi"</span>);</span><br><span class="line">	System.out.println(p);</span><br><span class="line">	</span><br><span class="line">	<span class="comment">//获取person方法</span></span><br><span class="line">	<span class="comment">//调用无参方法</span></span><br><span class="line">	Method m1 = clazz.getMethod(<span class="string">"show"</span>);</span><br><span class="line">	m1.invoke(p);</span><br><span class="line">	<span class="comment">//调用有参</span></span><br><span class="line">	Method m2 = clazz.getMethod(<span class="string">"display"</span>,String<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">	m2.invoke(p, <span class="string">"hhh"</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>输出结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Person [name&#x3D;null, age&#x3D;0]</span><br><span class="line">Person [name&#x3D;lisi, age&#x3D;0]</span><br><span class="line">Person show</span><br><span class="line">Person display:hhh</span><br></pre></td></tr></table></figure>

<p>demo：getClass方法的使用</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">demo3</span><span class="params">()</span></span>&#123;</span><br><span class="line">	Person p = <span class="keyword">new</span> Person();</span><br><span class="line">	<span class="comment">//通过运行时类的对象，调用其getClass()，返回其运行时类。</span></span><br><span class="line">	Class clazz = p.getClass();</span><br><span class="line">	System.out.println(clazz);</span><br><span class="line">	System.out.println(clazz.getName());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>输出结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">class reflect.Person</span><br><span class="line">reflect.Person</span><br></pre></td></tr></table></figure>

<h3 id="实例化Class类对象-四种方法"><a href="#实例化Class类对象-四种方法" class="headerlink" title="实例化Class类对象(四种方法)"></a>实例化Class类对象(四种方法)</h3><p>1）前提：若已知具体的类，通过类的class属性获取，该方法 最为安全可靠，程序性能最高<br>       实例：<code>Class clazz = String.class;</code><br>2）前提：已知某个类的实例，调用该实例的getClass()方法获取Class对象<br>       实例：<code>Class clazz = “www.baidu.com”.getClass();</code><br>3）前提：已知一个类的全类名，且该类在类路径下，可通过<br>       Class类的静态方法forName()获取，可能抛出ClassNotFoundException<br>       实例：<code>Class clazz = Class.forName(“java.lang.String”);</code><br>4）其他方式：<code>ClassLoader cl = this.getClass().getClassLoader();</code><br><code>Class clazz4 = cl.loadClass(“类的全类名”);</code></p>
<p>demo4:获取Class的实例(前三种)</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@org</span>.junit.Test</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">demo4</span><span class="params">()</span> <span class="keyword">throws</span> ClassNotFoundException</span>&#123;</span><br><span class="line">	<span class="comment">//1.调用运行时类本身的.class属性</span></span><br><span class="line">	Class clazz = Person<span class="class">.<span class="keyword">class</span></span>;</span><br><span class="line">	System.out.println(clazz.getName());</span><br><span class="line">	</span><br><span class="line">	Class clazz2 = String<span class="class">.<span class="keyword">class</span></span>;</span><br><span class="line">	System.out.println(clazz2.getName());</span><br><span class="line">	</span><br><span class="line">	<span class="comment">//2.通过运行时类的对象获取</span></span><br><span class="line">	Person p = <span class="keyword">new</span> Person();</span><br><span class="line">	Class clazz3 = p.getClass();</span><br><span class="line">	System.out.println(clazz3.getName());</span><br><span class="line">	</span><br><span class="line">	<span class="comment">//3.动态：通过Class的静态方法获取</span></span><br><span class="line">	String className = <span class="string">"reflect.Person"</span>;</span><br><span class="line">	Class clazz4 = Class.forName(className);</span><br><span class="line">	System.out.println(clazz4.getName());</span><br><span class="line">	 </span><br><span class="line">	<span class="comment">//4.动态：通过类加载器</span></span><br><span class="line">	ClassLoader cl = <span class="keyword">this</span>.getClass().getClassLoader();</span><br><span class="line">	Class clazz5 = cl.loadClass(className);</span><br><span class="line">	System.out.println(clazz5.getName());</span><br><span class="line">	System.out.println(clazz1 == clazz3);</span><br><span class="line">	System.out.println(clazz1 == clazz4);</span><br><span class="line">	System.out.println(clazz1 == clazz5);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>输出结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">reflect.Person</span><br><span class="line">java.lang.String</span><br><span class="line">reflect.Person</span><br><span class="line">reflect.Person</span><br><span class="line">reflect.Person</span><br><span class="line">true</span><br><span class="line">true</span><br><span class="line">true</span><br></pre></td></tr></table></figure>

<h3 id="类加载器"><a href="#类加载器" class="headerlink" title="类加载器"></a>类加载器</h3><h4 id="类的加载过程"><a href="#类的加载过程" class="headerlink" title="类的加载过程"></a>类的加载过程</h4><p>当程序主动使用某个类时，如果该类还未被加载到内存中，则系统会通过如下三个步骤来对该类进行初始化。</p>
<p><img src="http://img.bcoder.top/2017.06.11/3.png" alt="Java反射机制"></p>
<p><img src="http://img.bcoder.top/2017.06.11/4.png" alt="Java反射机制"></p>
<h4 id="ClassLoader-流程"><a href="#ClassLoader-流程" class="headerlink" title="ClassLoader 流程"></a>ClassLoader 流程</h4><p>类加载器是用来把类(class)装载进内存的。JVM 规范定义了两种类型的类加载器：启动类加载器(bootstrap)和用户自定义加载器(user-defined class loader)。 JVM在运行时会产生3个类加载器组成的初始化加载器层次结构 ，如下图所示：</p>
<p><img src="http://img.bcoder.top/2017.06.11/5.png" alt="Java反射机制"></p>
<h4 id="ClassLoader-使用"><a href="#ClassLoader-使用" class="headerlink" title="ClassLoader 使用"></a>ClassLoader 使用</h4><p>demo5: ClassLoader 使用以及应用</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@org</span>.junit.Test</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">demo5</span><span class="params">()</span> <span class="keyword">throws</span> ClassNotFoundException, IOException</span>&#123;</span><br><span class="line">	ClassLoader loader1 = ClassLoader.getSystemClassLoader();</span><br><span class="line">	System.out.println(loader1);</span><br><span class="line">	</span><br><span class="line">	ClassLoader loader2 = loader1.getParent();</span><br><span class="line">	System.out.println(loader2);</span><br><span class="line">	</span><br><span class="line">	ClassLoader loader3 = loader2.getParent();</span><br><span class="line">	System.out.println(loader3);<span class="comment">//引导类加载器无法直接获取</span></span><br><span class="line">	</span><br><span class="line">	Class clazz = Person<span class="class">.<span class="keyword">class</span></span>;</span><br><span class="line">	ClassLoader loader4 = clazz.getClassLoader();</span><br><span class="line">	System.out.println(loader4);</span><br><span class="line">	</span><br><span class="line">	String className = <span class="string">"java.lang.Object"</span>;</span><br><span class="line">	Class clazz2 = Class.forName(className);</span><br><span class="line">	ClassLoader loader5 = clazz2.getClassLoader();</span><br><span class="line">	System.out.println(loader5);</span><br><span class="line">	</span><br><span class="line">	<span class="comment">//具体应用：加载properties文件</span></span><br><span class="line">	<span class="comment">//法一：</span></span><br><span class="line">	ClassLoader loader = <span class="keyword">this</span>.getClass().getClassLoader();</span><br><span class="line">	InputStream is = loader.getResourceAsStream(<span class="string">"jdbc.properties"</span>);</span><br><span class="line">	<span class="comment">//法二：</span></span><br><span class="line">	<span class="comment">//FileInputStream is = new FileInputStream(new File("jdbc.properties"));</span></span><br><span class="line">	</span><br><span class="line">	Properties pros = <span class="keyword">new</span> Properties();</span><br><span class="line">	pros.load(is);</span><br><span class="line">	String name = pros.getProperty(<span class="string">"user"</span>);</span><br><span class="line">	System.out.println(name);</span><br><span class="line">	</span><br><span class="line">	String password = pros.getProperty(<span class="string">"password"</span>);</span><br><span class="line">	System.out.println(password);</span><br><span class="line">	</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<p>jdbc.properties</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">user=root</span><br><span class="line">password=admin</span><br></pre></td></tr></table></figure>
<p>输出结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">sun.misc.Launcher$AppClassLoader@63c78e57</span><br><span class="line">sun.misc.Launcher$ExtClassLoader@425224ee</span><br><span class="line">null</span><br><span class="line">sun.misc.Launcher$AppClassLoader@63c78e57</span><br><span class="line">null</span><br><span class="line">root</span><br><span class="line">admin</span><br></pre></td></tr></table></figure>


<h2 id="创建类对象并获取类的完整结构"><a href="#创建类对象并获取类的完整结构" class="headerlink" title="创建类对象并获取类的完整结构"></a>创建类对象并获取类的完整结构</h2><h3 id="创建类的对象"><a href="#创建类的对象" class="headerlink" title="创建类的对象"></a>创建类的对象</h3><p>调用Class对象的newInstance()方法<br>要  求：</p>
<ul>
<li>类必须有一个无参数的构造器。</li>
<li>类的构造器的访问权限需要足够。</li>
</ul>
<p><strong>难道没有无参的构造器就不能创建对象了吗？</strong><br>不是！只要在操作的时候明确的调用类中的构造方法，并将参数传递进去之后，才可以实例化操作。步骤如下：</p>
<ul>
<li>通过Class类的getDeclaredConstructor(Class … parameterTypes)取得本类的指定形参类型的构造器</li>
<li>向构造器的形参中传递一个对象数组进去，里面包含了构造器中所需的各个参数。</li>
<li>调用constructor.newInstance(initargs)</li>
</ul>
<p>demo:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@org</span>.junit.Test</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">demo6</span><span class="params">()</span> <span class="keyword">throws</span> Exception</span>&#123;</span><br><span class="line">	String className = <span class="string">"reflect.Person"</span>;</span><br><span class="line">	Class clazz = Class.forName(className);</span><br><span class="line">	<span class="comment">//默认调用的是无参构造器，没有无参构造器无法使用该方法 </span></span><br><span class="line">	Person p = (Person)clazz.newInstance();</span><br><span class="line">	System.out.println(p);</span><br><span class="line">	</span><br><span class="line">	<span class="comment">//调用有参构造器创建实例</span></span><br><span class="line">	Constructor constructor = clazz.getDeclaredConstructor(String<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">	Person p2 = (Person) constructor.newInstance(<span class="string">"wangwu"</span>);</span><br><span class="line">	System.out.println(p2);</span><br><span class="line">	</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>输出结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Person [name&#x3D;null, age&#x3D;0]</span><br><span class="line">Person [name&#x3D;wangwu, age&#x3D;0]</span><br></pre></td></tr></table></figure>

<h2 id="通过反射调用类的结构"><a href="#通过反射调用类的结构" class="headerlink" title="通过反射调用类的结构"></a>通过反射调用类的结构</h2><h3 id="通过反射调用类中获取全部的特性"><a href="#通过反射调用类中获取全部的特性" class="headerlink" title="通过反射调用类中获取全部的特性"></a>通过反射调用类中获取全部的特性</h3><p><strong>使用反射可以取得：</strong><br>1.实现的全部接口<br><code>public Class&lt;?&gt;[] getInterfaces()</code><br>确定此对象所表示的类或接口实现的接口。 </p>
<p>2.所继承的父类<br><code>public Class&lt;? Super T&gt; getSuperclass()</code><br>返回表示此 Class 所表示的实体（类、接口、基本类型）的父类的 Class。</p>
<p>3.全部的构造器<br><code>public Constructor&lt;T&gt;[] getConstructors()</code><br>返回此 Class 对象所表示的类的所有public构造方法。<br><code>public Constructor&lt;T&gt;[] getDeclaredConstructors()</code><br>返回此 Class 对象表示的类声明的所有构造方法。</p>
<p>Constructor类中：<br>取得修饰符:<code>public int getModifiers();</code><br>取得方法名称:<code>public String getName();</code><br>取得参数的类型：<code>public Class&lt;?&gt;[] getParameterTypes();</code></p>
<p>4.全部的方法<br><code>public Method[] getDeclaredMethods()</code><br>返回此Class对象所表示的类或接口的全部方法<br><code>public Method[] getMethods()</code><br>返回此Class对象所表示的类或接口的public的方法</p>
<p>Method类中：<br><code>public Class&lt;?&gt; getReturnType()</code>取得全部的返回值<br><code>public Class&lt;?&gt;[] getParameterTypes()</code>取得全部的参数<br><code>public int getModifiers()</code>取得修饰符<br><code>public Class&lt;?&gt;[] getExceptionTypes()</code>取得异常信息</p>
<p>5.全部的Field<br><code>public Field[] getFields()</code><br>返回此Class对象所表示的类或接口的public的Field。<br><code>public Field[] getDeclaredFields()</code><br>返回此Class对象所表示的类或接口的全部Field。</p>
<p>Field方法中：<br><code>public int getModifiers()</code>  以整数形式返回此Field的修饰符<br><code>public Class&lt;?&gt; getType()</code> 得到Field的属性类型<br><code>public String getName()</code>  返回Field的名称。</p>
<ol start="6">
<li>Annotation相关<br><code>get Annotation(Class&lt;T&gt; annotationClass)</code><br><code>getDeclaredAnnotations()</code></li>
</ol>
<p>7.泛型相关<br>获取父类泛型类型：<code>Type getGenericSuperclass()</code><br>泛型类型：<code>ParameterizedType</code><br>获取实际的泛型类型参数数组：<code>getActualTypeArguments()</code></p>
<p>8.类所在的包    <code>Package getPackage()</code></p>
<h3 id="通过反射调用类中的指定方法、指定属性"><a href="#通过反射调用类中的指定方法、指定属性" class="headerlink" title="通过反射调用类中的指定方法、指定属性"></a>通过反射调用类中的指定方法、指定属性</h3><h4 id="调用指定方法"><a href="#调用指定方法" class="headerlink" title="调用指定方法"></a>调用指定方法</h4><p>通过反射，调用类中的方法，通过Method类完成。步骤：</p>
<ul>
<li>通过Class类的getMethod(String name,Class…parameterTypes)方法取得一个Method对象，并设置此方法操作时所需要的参数类型。</li>
<li>之后使用Object invoke(Object obj, Object[] args)进行调用，并向方法中传递要设置的obj对象的参数信息。</li>
</ul>
<p><img src="http://img.bcoder.top/2017.06.11/6.png" alt="Java反射机制"></p>
<p>对<code>Object invoke(Object obj, Object …  args)</code>的说明：</p>
<ul>
<li>Object 对应原方法的返回值，若原方法无返回值，此时返回null</li>
<li>若原方法若为静态方法，此时形参Object obj可为null</li>
<li>若原方法形参列表为空，则Object[] args为null</li>
<li>若原方法声明为private,则需要在调用此invoke()方法前，显式调用方法对象的setAccessible(true)方法，将可访问private的方法。</li>
</ul>
<h4 id="调用指定属性"><a href="#调用指定属性" class="headerlink" title="调用指定属性"></a>调用指定属性</h4><p>在反射机制中，可以直接通过Field类操作类中的属性，通过Field类提供的set()和get()方法就可以完成设置和取得属性内容的操作。<br><code>public Field getField(String name)</code> 返回此Class对象表示的类或接口的指定的public的Field。<br><code>public Field getDeclaredField(String name)</code>返回此Class对象表示的类或接口的指定的Field。</p>
<p>在Field中：<br><code>public Object get(Object obj)</code>取得指定对象obj上此Field的属性内容<br><code>public void set(Object obj,Object value)</code>设置指定对象obj上此Field的属性内容</p>
<p>注：在类中属性都设置为<code>private</code>的前提下，在使用<code>set()</code>和<code>get()</code>方法时，首先要使用Field类中的<code>setAccessible(true)</code>方法将需要操作的属性设置为可以被外部访问。<br><code>public void setAccessible(true)</code>访问私有属性时，让这个属性可见。 </p>
<p>demo:<br>搭建测试环境</p>
<p>定义接口：MyInterface.java</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> reflect;</span><br><span class="line"><span class="keyword">import</span> java.io.Serializable;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">MyInterface</span> <span class="keyword">extends</span> <span class="title">Serializable</span></span>&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>定义注解：MyAnnotation.java</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> reflect;</span><br><span class="line"><span class="keyword">import</span> <span class="keyword">static</span> java.lang.annotation.ElementType.CONSTRUCTOR;</span><br><span class="line"><span class="keyword">import</span> <span class="keyword">static</span> java.lang.annotation.ElementType.FIELD;</span><br><span class="line"><span class="keyword">import</span> <span class="keyword">static</span> java.lang.annotation.ElementType.LOCAL_VARIABLE;</span><br><span class="line"><span class="keyword">import</span> <span class="keyword">static</span> java.lang.annotation.ElementType.METHOD;</span><br><span class="line"><span class="keyword">import</span> <span class="keyword">static</span> java.lang.annotation.ElementType.PARAMETER;</span><br><span class="line"><span class="keyword">import</span> <span class="keyword">static</span> java.lang.annotation.ElementType.TYPE;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.lang.annotation.Retention;</span><br><span class="line"><span class="keyword">import</span> java.lang.annotation.RetentionPolicy;</span><br><span class="line"><span class="keyword">import</span> java.lang.annotation.Target;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Target</span>(&#123;TYPE, FIELD, METHOD, PARAMETER, CONSTRUCTOR, LOCAL_VARIABLE&#125;)</span><br><span class="line"><span class="meta">@Retention</span>(RetentionPolicy.RUNTIME)</span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> MyAnnotation &#123;</span><br><span class="line">	<span class="function">String <span class="title">value</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>定义父类：Creature.java</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> reflect;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Creature</span>&lt;<span class="title">T</span>&gt;</span>&#123;</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">double</span> weight;</span><br><span class="line">	 </span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">breath</span><span class="params">()</span></span>&#123;</span><br><span class="line">		System.out.println(<span class="string">"呼吸！"</span>);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>定义实体类Person,java(与之前有所不同)</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> reflect;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@MyAnnotation</span>(value = <span class="string">"zln"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Person</span> <span class="keyword">extends</span> <span class="title">Creature</span>&lt;<span class="title">String</span>&gt; <span class="keyword">implements</span> <span class="title">Comparable</span>,<span class="title">MyInterface</span></span>&#123;</span><br><span class="line">	<span class="keyword">public</span> String name;</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">int</span> age;</span><br><span class="line">	<span class="keyword">int</span> id;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">Person</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">Person</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">super</span>();</span><br><span class="line">		<span class="keyword">this</span>.name = name;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">Person</span><span class="params">(String name, <span class="keyword">int</span> age)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">super</span>();</span><br><span class="line">		<span class="keyword">this</span>.name = name;</span><br><span class="line">		<span class="keyword">this</span>.age = age;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> name;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.name = name;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getAge</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> age;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setAge</span><span class="params">(<span class="keyword">int</span> age)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.age = age;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@MyAnnotation</span>(value=<span class="string">"abc"</span>)</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">show</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		System.out.println(<span class="string">"Person show"</span>);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">display</span><span class="params">(String str)</span> <span class="keyword">throws</span> Exception</span>&#123;</span><br><span class="line">		System.out.println(<span class="string">"Person display:"</span>+str);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="string">"Person [name="</span> + name + <span class="string">", age="</span> + age + <span class="string">"]"</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">compareTo</span><span class="params">(Object o)</span> </span>&#123;</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="class"><span class="keyword">class</span> <span class="title">Bird</span></span>&#123;</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>测试：</p>
<p><strong>通过反射获取Field</strong><br>demo7:获取对应的运行时类的属性</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@org</span>.junit.Test</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">demo7</span><span class="params">()</span></span>&#123;</span><br><span class="line">	Class clazz = Person<span class="class">.<span class="keyword">class</span></span>;</span><br><span class="line">	<span class="comment">//1.getFields():只能获取到运行时类中及其父类中声明为public的属性</span></span><br><span class="line">	Field[] fields = clazz.getFields();</span><br><span class="line">	System.out.println(<span class="string">"===getFields:"</span>);</span><br><span class="line">	<span class="keyword">for</span> (Field field : fields) &#123;</span><br><span class="line">		System.out.println(field.getName());</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">//2.getDeclaredFields():获取运行时类本身声明的所有的属性</span></span><br><span class="line">	System.out.println(<span class="string">"===getDeclaredFields:"</span>);</span><br><span class="line">	Field[] fields2 = clazz.getDeclaredFields();</span><br><span class="line">	<span class="keyword">for</span> (Field field : fields2) &#123;</span><br><span class="line">		System.out.println(field.getName());</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>输出结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&#x3D;&#x3D;&#x3D;getFields:</span><br><span class="line">name</span><br><span class="line">weight</span><br><span class="line">&#x3D;&#x3D;&#x3D;getDeclaredFields:</span><br><span class="line">name</span><br><span class="line">age</span><br><span class="line">id</span><br></pre></td></tr></table></figure>

<p>demo8:获取属性的各个部分的内容:权限修饰符  变量类型 变量名</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@org</span>.junit.Test</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">demo8</span><span class="params">()</span></span>&#123;</span><br><span class="line">	Class clazz = Person<span class="class">.<span class="keyword">class</span></span>;</span><br><span class="line">	Field[] fields1 = clazz.getDeclaredFields();</span><br><span class="line">	<span class="keyword">for</span>(Field f : fields1)&#123;</span><br><span class="line">		<span class="comment">//1.获取每个属性的权限修饰符</span></span><br><span class="line">		<span class="keyword">int</span> i = f.getModifiers();</span><br><span class="line">		String str1 = Modifier.toString(i);</span><br><span class="line">		System.out.print(str1 + <span class="string">" "</span>);</span><br><span class="line">		<span class="comment">//2.获取属性的类型</span></span><br><span class="line">		Class type = f.getType();</span><br><span class="line">		System.out.print(type.getName() + <span class="string">" "</span>);</span><br><span class="line">		<span class="comment">//3.获取属性名</span></span><br><span class="line">		System.out.print(f.getName());</span><br><span class="line">		</span><br><span class="line">		System.out.println();</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>输出结果：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> java.lang.String name</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">int</span> age</span><br><span class="line"> <span class="keyword">int</span> id</span><br></pre></td></tr></table></figure>


<p>demo9:调用运行时类中指定的属性</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@org</span>.junit.Test</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">demo9</span><span class="params">()</span> <span class="keyword">throws</span> Exception</span>&#123;</span><br><span class="line"></span><br><span class="line">	Class clazz = Person<span class="class">.<span class="keyword">class</span></span>;</span><br><span class="line">	<span class="comment">//1.获取指定的属性</span></span><br><span class="line">	<span class="comment">//getField(String fieldName):获取运行时类中声明为public的指定属性名为fieldName的属性</span></span><br><span class="line">	Field name = clazz.getField(<span class="string">"name"</span>);</span><br><span class="line">	<span class="comment">//2.创建运行时类的对象 </span></span><br><span class="line">	Person p = (Person)clazz.newInstance();</span><br><span class="line">	System.out.println(p);</span><br><span class="line">	<span class="comment">//3.将运行时类的指定的属性赋值</span></span><br><span class="line">	name.set(p,<span class="string">"Jerry"</span>);</span><br><span class="line">	System.out.println(p);</span><br><span class="line">	System.out.println(<span class="string">"%"</span>+name.get(p));</span><br><span class="line"></span><br><span class="line">	System.out.println();</span><br><span class="line">	<span class="comment">//getDeclaredField(String fieldName):获取运行时类中指定的名为fieldName的属性</span></span><br><span class="line">	Field age = clazz.getDeclaredField(<span class="string">"age"</span>);</span><br><span class="line">	<span class="comment">//由于属性权限修饰符的限制，为了保证可以给属性赋值，需要在操作前使得此属性可被操作。</span></span><br><span class="line">	age.setAccessible(<span class="keyword">true</span>);</span><br><span class="line">	age.set(p,<span class="number">10</span>);</span><br><span class="line">	System.out.println(p);</span><br><span class="line"></span><br><span class="line">	<span class="comment">//	Field id = clazz.getField("id");</span></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>输出结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Person [name&#x3D;null, age&#x3D;0]</span><br><span class="line">Person [name&#x3D;Jerry, age&#x3D;0]</span><br><span class="line">%Jerry</span><br><span class="line"></span><br><span class="line">Person [name&#x3D;Jerry, age&#x3D;10]</span><br></pre></td></tr></table></figure>

<p><strong>反射获取Method</strong><br>demo10:获取运行时类的方法</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@org</span>.junit.Test</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">demo10</span><span class="params">()</span></span>&#123;</span><br><span class="line">	Class clazz = Person<span class="class">.<span class="keyword">class</span></span>;</span><br><span class="line">	<span class="comment">//1.getMethods():获取运行时类及其父类中所有的声明为public的方法</span></span><br><span class="line">	Method[] m1 = clazz.getMethods();</span><br><span class="line">	System.out.println(<span class="string">"getMethods:"</span>);</span><br><span class="line">	<span class="keyword">for</span>(Method m : m1)&#123;</span><br><span class="line">		System.out.println(m);</span><br><span class="line">	&#125;</span><br><span class="line">	System.out.println();</span><br><span class="line">	</span><br><span class="line">	<span class="comment">//2.getDeclaredMethods():获取运行时类本身声明的所有的方法</span></span><br><span class="line">	Method[] m2 = clazz.getDeclaredMethods();</span><br><span class="line">	System.out.println(<span class="string">"getDeclaredMethods:"</span>);</span><br><span class="line">	<span class="keyword">for</span>(Method m : m2)&#123;</span><br><span class="line">		System.out.println(m);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>输出结果：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">getMethods:</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">int</span> reflect.Person.compareTo(java.lang.Object)</span><br><span class="line"><span class="keyword">public</span> java.lang.String reflect.Person.toString()</span><br><span class="line"><span class="keyword">public</span> java.lang.String reflect.Person.getName()</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> reflect.Person.setName(java.lang.String)</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> reflect.Person.setAge(<span class="keyword">int</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> reflect.Person.show()</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">int</span> reflect.Person.getAge()</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> reflect.Creature.breath()</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">void</span> java.lang.Object.wait() <span class="keyword">throws</span> java.lang.InterruptedException</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">void</span> java.lang.Object.wait(<span class="keyword">long</span>,<span class="keyword">int</span>) <span class="keyword">throws</span> java.lang.InterruptedException</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">native</span> <span class="keyword">void</span> java.lang.Object.wait(<span class="keyword">long</span>) <span class="keyword">throws</span> java.lang.InterruptedException</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">native</span> <span class="keyword">int</span> java.lang.Object.hashCode()</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">native</span> java.lang.Class java.lang.Object.getClass()</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">boolean</span> java.lang.Object.equals(java.lang.Object)</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">native</span> <span class="keyword">void</span> java.lang.Object.notify()</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">native</span> <span class="keyword">void</span> java.lang.Object.notifyAll()</span><br><span class="line"></span><br><span class="line">getDeclaredMethods:</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">int</span> reflect.Person.compareTo(java.lang.Object)</span><br><span class="line"><span class="keyword">public</span> java.lang.String reflect.Person.toString()</span><br><span class="line"><span class="keyword">public</span> java.lang.String reflect.Person.getName()</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> reflect.Person.setName(java.lang.String)</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> reflect.Person.setAge(<span class="keyword">int</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> reflect.Person.show()</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">void</span> reflect.Person.display(java.lang.String) <span class="keyword">throws</span> java.lang.Exception</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">int</span> reflect.Person.getAge()</span><br></pre></td></tr></table></figure>


<p>demo11:获取方法的：注解 权限修饰符 返回值类型 方法名 形参列表 异常</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@org</span>.junit.Test</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">demo11</span><span class="params">()</span> </span>&#123;</span><br><span class="line">Class clazz = Person<span class="class">.<span class="keyword">class</span></span>;</span><br><span class="line"></span><br><span class="line">Method[] m2 = clazz.getDeclaredMethods();</span><br><span class="line"><span class="keyword">for</span> (Method m : m2) &#123;</span><br><span class="line">	System.out.println(m.getName()+<span class="string">"方法:"</span>);</span><br><span class="line">	<span class="comment">// 1.注解</span></span><br><span class="line">	System.out.println(<span class="string">"获取方法注解："</span>);</span><br><span class="line">	Annotation[] ann = m.getAnnotations();</span><br><span class="line">	<span class="keyword">for</span> (Annotation a : ann) &#123;</span><br><span class="line">		System.out.println(a);</span><br><span class="line">	&#125;</span><br><span class="line">	System.out.println();</span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line">	<span class="comment">// 2.权限修饰符</span></span><br><span class="line">	System.out.println(<span class="string">"获取方法权限修饰符："</span>);</span><br><span class="line">	String str = Modifier.toString(m.getModifiers());</span><br><span class="line">	System.out.print(str + <span class="string">" "</span>);</span><br><span class="line">	System.out.println();</span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line">	<span class="comment">// 3.返回值类型</span></span><br><span class="line">	System.out.println(<span class="string">"获取方法返回值类型："</span>);</span><br><span class="line">	Class returnType = m.getReturnType();</span><br><span class="line">	System.out.print(returnType.getName() + <span class="string">" "</span>);</span><br><span class="line">	System.out.println();</span><br><span class="line">	</span><br><span class="line">	<span class="comment">// 4.方法名</span></span><br><span class="line">	System.out.println(<span class="string">"获取方法名："</span>);</span><br><span class="line">	System.out.print(m.getName() + <span class="string">" "</span>);</span><br><span class="line">	System.out.println();</span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line">	<span class="comment">// 5.形参列表</span></span><br><span class="line">	System.out.println(<span class="string">"获取方法形参列表："</span>);</span><br><span class="line">	System.out.print(<span class="string">"("</span>);</span><br><span class="line">	Class[] params = m.getParameterTypes();</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; params.length; i++) &#123;</span><br><span class="line">		System.out.print(params[i].getName() + <span class="string">" args-"</span> + i + <span class="string">" "</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	System.out.print(<span class="string">")"</span>);</span><br><span class="line">	System.out.println();</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 6.异常类型</span></span><br><span class="line">	System.out.println(<span class="string">"获取方法异常类型："</span>);</span><br><span class="line">	Class[] exps = m.getExceptionTypes();</span><br><span class="line">	<span class="keyword">if</span> (exps.length != <span class="number">0</span>) &#123;</span><br><span class="line">		System.out.print(<span class="string">"throws "</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; exps.length; i++) &#123;</span><br><span class="line">		System.out.print(exps[i].getName() + <span class="string">" "</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	System.out.println();</span><br><span class="line">	System.out.println();</span><br><span class="line">	System.out.println();</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>输出结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">compareTo方法:</span><br><span class="line">获取方法注解：</span><br><span class="line"></span><br><span class="line">获取方法权限修饰符：</span><br><span class="line">public </span><br><span class="line">获取方法返回值类型：</span><br><span class="line">int </span><br><span class="line">获取方法名：</span><br><span class="line">compareTo </span><br><span class="line">获取方法形参列表：</span><br><span class="line">(java.lang.Object args-0 )</span><br><span class="line">获取方法异常类型：</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">toString方法:</span><br><span class="line">获取方法注解：</span><br><span class="line"></span><br><span class="line">获取方法权限修饰符：</span><br><span class="line">public </span><br><span class="line">获取方法返回值类型：</span><br><span class="line">java.lang.String </span><br><span class="line">获取方法名：</span><br><span class="line">toString </span><br><span class="line">获取方法形参列表：</span><br><span class="line">()</span><br><span class="line">获取方法异常类型：</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">getName方法:</span><br><span class="line">获取方法注解：</span><br><span class="line"></span><br><span class="line">获取方法权限修饰符：</span><br><span class="line">public </span><br><span class="line">获取方法返回值类型：</span><br><span class="line">java.lang.String </span><br><span class="line">获取方法名：</span><br><span class="line">getName </span><br><span class="line">获取方法形参列表：</span><br><span class="line">()</span><br><span class="line">获取方法异常类型：</span><br><span class="line">.....(其他方法未列出)</span><br></pre></td></tr></table></figure>

<p>demo12:调用运行时类中指定的方法<br>在Person类中添加两个方法：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">info</span><span class="params">()</span></span>&#123;</span><br><span class="line">	System.out.println(<span class="string">"中国人！"</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">private</span> Integer <span class="title">display</span><span class="params">(String nation,Integer i)</span> <span class="keyword">throws</span> Exception</span>&#123;</span><br><span class="line">	System.out.println(<span class="string">"我的国籍是："</span> + nation);</span><br><span class="line">	<span class="keyword">return</span> i;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@org</span>.junit.Test</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">demo12</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">	Class clazz = Person<span class="class">.<span class="keyword">class</span></span>;</span><br><span class="line">	<span class="comment">//getMethod(String methodName,Class ... params):获取运行时类中声明为public的指定的方法</span></span><br><span class="line">	Method m1 = clazz.getMethod(<span class="string">"show"</span>);</span><br><span class="line">	Person p = (Person)clazz.newInstance();</span><br><span class="line">	<span class="comment">//调用指定的方法：Object invoke(Object obj,Object ... obj)</span></span><br><span class="line">	Object returnVal = m1.invoke(p);<span class="comment">//我是一个人</span></span><br><span class="line">	System.out.println(returnVal);<span class="comment">//null</span></span><br><span class="line">	</span><br><span class="line">	Method m2 = clazz.getMethod(<span class="string">"toString"</span>);</span><br><span class="line">	Object returnVal1 = m2.invoke(p);</span><br><span class="line">	System.out.println(returnVal1);<span class="comment">//Person [name=null, age=0]</span></span><br><span class="line">	<span class="comment">//对于运行时类中静态方法的调用</span></span><br><span class="line">	Method m3 = clazz.getMethod(<span class="string">"info"</span>);</span><br><span class="line">	m3.invoke(Person<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">//getDeclaredMethod(String methodName,Class ... params):获取运行时类中声明了的指定的方法</span></span><br><span class="line">	Method m4 = clazz.getDeclaredMethod(<span class="string">"display"</span>,String<span class="class">.<span class="keyword">class</span>,<span class="title">Integer</span>.<span class="title">class</span>)</span>;</span><br><span class="line">	m4.setAccessible(<span class="keyword">true</span>);</span><br><span class="line">	Object value = m4.invoke(p,<span class="string">"CHN"</span>,<span class="number">10</span>);<span class="comment">//我的国籍是：CHN</span></span><br><span class="line">	System.out.println(value);<span class="comment">//10</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>输出结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Person show</span><br><span class="line">null</span><br><span class="line">Person [name&#x3D;null, age&#x3D;0]</span><br><span class="line">中国人！</span><br><span class="line">我的国籍是：CHN</span><br><span class="line">10</span><br></pre></td></tr></table></figure>




<p><strong>反射获取构造器</strong></p>
<p>demo13:反射获取无参构造器</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@org</span>.junit.Test</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">demo13</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">	String className = <span class="string">"reflect.Person"</span>;</span><br><span class="line">	Class clazz = Class.forName(className);</span><br><span class="line">	<span class="comment">//创建对应的运行时类的对象。使用newInstance()，实际上就是调用了运行时类的空参的构造器。</span></span><br><span class="line">	<span class="comment">//要想能够创建成功：①要求对应的运行时类要有空参的构造器。②构造器的权限修饰符的权限要足够。</span></span><br><span class="line">	Object obj = clazz.newInstance();</span><br><span class="line">	Person p = (Person)obj;</span><br><span class="line">	System.out.println(p);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>输出结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Person [name&#x3D;null, age&#x3D;0]</span><br></pre></td></tr></table></figure>


<p>demo14:反射获取所有构造器</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@org</span>.junit.Test</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">demo14</span><span class="params">()</span> <span class="keyword">throws</span> ClassNotFoundException </span>&#123;</span><br><span class="line">	String className = <span class="string">"reflect.Person"</span>;</span><br><span class="line">	Class clazz = Class.forName(className);</span><br><span class="line">	</span><br><span class="line">	Constructor[] cons = clazz.getDeclaredConstructors();</span><br><span class="line">	<span class="keyword">for</span>(Constructor c : cons)&#123;</span><br><span class="line">		System.out.println(c);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>输出结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">public reflect.Person(java.lang.String)</span><br><span class="line">public reflect.Person(java.lang.String,int)</span><br><span class="line">public reflect.Person()</span><br></pre></td></tr></table></figure>


<p>demo15:反射获取指定构造器(前面提到过)</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@org</span>.junit.Test</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">demo15</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">	String className = <span class="string">"reflect.Person"</span>;</span><br><span class="line">	Class clazz = Class.forName(className);</span><br><span class="line">	</span><br><span class="line">	Constructor cons = clazz.getDeclaredConstructor(String<span class="class">.<span class="keyword">class</span>,<span class="title">int</span>.<span class="title">class</span>)</span>;</span><br><span class="line">	cons.setAccessible(<span class="keyword">true</span>);</span><br><span class="line">	Person p = (Person)cons.newInstance(<span class="string">"zln"</span>,<span class="number">20</span>);</span><br><span class="line">	System.out.println(p);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>输出结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Person [name&#x3D;zln, age&#x3D;20]</span><br></pre></td></tr></table></figure>


<p><strong>反射获取其他</strong></p>
<p>demo16:获取运行时类的父类</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">demo16</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	Class clazz = Person<span class="class">.<span class="keyword">class</span></span>;</span><br><span class="line">	Class superClass = clazz.getSuperclass();</span><br><span class="line">	System.out.println(superClass);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>输出结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">class reflect.Creature</span><br></pre></td></tr></table></figure>

<p>demo17:获取带泛型的父类</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@org</span>.junit.Test</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">demo17</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	Class clazz = Person<span class="class">.<span class="keyword">class</span></span>;</span><br><span class="line">	Type type1 = clazz.getGenericSuperclass();</span><br><span class="line">	System.out.println(type1);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>输出结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">reflect.Creature&lt;java.lang.String&gt;</span><br></pre></td></tr></table></figure>



<p>demo18:获取父类的泛型</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@org</span>.junit.Test</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">demo18</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	Class clazz = Person<span class="class">.<span class="keyword">class</span></span>;</span><br><span class="line">	Type type1 = clazz.getGenericSuperclass();</span><br><span class="line">	</span><br><span class="line">	ParameterizedType param = (ParameterizedType)type1;</span><br><span class="line">	Type[] ars = param.getActualTypeArguments();</span><br><span class="line">	</span><br><span class="line">	System.out.println(((Class)ars[<span class="number">0</span>]).getName());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>输出结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java.lang.String</span><br></pre></td></tr></table></figure>

<p>demo19:获取实现的接口</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@org</span>.junit.Test</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">demo19</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	Class clazz = Person<span class="class">.<span class="keyword">class</span></span>;</span><br><span class="line">	Class[] interfaces = clazz.getInterfaces();</span><br><span class="line">	<span class="keyword">for</span>(Class i : interfaces)&#123;</span><br><span class="line">		System.out.println(i);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>输出结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">interface java.lang.Comparable</span><br><span class="line">interface reflect.MyInterface</span><br></pre></td></tr></table></figure>



<p>demo20:获取所在的包</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@org</span>.junit.Test</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">demo20</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	Class clazz = Person<span class="class">.<span class="keyword">class</span></span>;</span><br><span class="line">	Package pack = clazz.getPackage();</span><br><span class="line">	System.out.println(pack);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>输出结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">package reflect</span><br></pre></td></tr></table></figure>



<p>demo21:获取类上面的注解（声明周期为runtime）</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@org</span>.junit.Test</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">demo21</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	Class clazz = Person<span class="class">.<span class="keyword">class</span></span>;</span><br><span class="line">	Annotation[] anns = clazz.getAnnotations();</span><br><span class="line">	<span class="keyword">for</span>(Annotation a : anns)&#123;</span><br><span class="line">		System.out.println(a);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>输出结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">@reflect.MyAnnotation(value&#x3D;zln)</span><br></pre></td></tr></table></figure>


<h2 id="反射应用：Java动态代理"><a href="#反射应用：Java动态代理" class="headerlink" title="反射应用：Java动态代理"></a>反射应用：Java动态代理</h2><p>动态代理是指客户通过代理类来调用其它对象的方法，并且是在程序运行时根据需要动态创建目标类的代理对象。</p>
<p>动态代理<strong>使用场合</strong>:</p>
<ul>
<li>调试</li>
<li>远程方法调用</li>
</ul>
<p><strong>代理设计模式的原理</strong>:<br>使用一个代理将对象包装起来, 然后用该代理对象取代原始对象. 任何对原始对象的调用都要通过代理. 代理对象决定是否以及何时将方法调用转到原始对象上</p>
<p>说一说静态代理（简单代理模式），它与策略模式很像，下面简单说说它们两者的区别：<br>简单代理模式中，代理类知道被代理类的行为，因为代理类与被代理类实现的是同一个接口，因此代理类与被代理类的结构是相同的；<br>而策略模式中，策略容器并不知道内部策略的详细信息，因为容器并没有实现与内部策略相同的接口，即容器与内部策略只是简单的组合关系，容器只是将内部策略的行为抽取出来，进行了统一的实现。<br>提供用于创建动态代理类和动态代理对象的静态方法：</p>
<p>demo:静态代理实现</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> reflect;</span><br><span class="line"></span><br><span class="line"><span class="comment">//静态代理模式</span></span><br><span class="line"><span class="comment">//接口</span></span><br><span class="line"><span class="class"><span class="keyword">interface</span> <span class="title">ClothFactory</span></span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">productCloth</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//被代理类</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">NikeClothFactory</span> <span class="keyword">implements</span> <span class="title">ClothFactory</span></span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">productCloth</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		System.out.println(<span class="string">"Nike工厂生产一批衣服"</span>);</span><br><span class="line">	&#125;	</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//代理类</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ProxyFactory</span> <span class="keyword">implements</span> <span class="title">ClothFactory</span></span>&#123;</span><br><span class="line">	ClothFactory cf;</span><br><span class="line">	<span class="comment">//创建代理类的对象时，实际传入一个被代理类的对象</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">ProxyFactory</span><span class="params">(ClothFactory cf)</span></span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.cf = cf;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">productCloth</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		System.out.println(<span class="string">"代理类开始执行，收代理费$1000"</span>);</span><br><span class="line">		cf.productCloth();</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">StaticProxy</span> </span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		NikeClothFactory nike = <span class="keyword">new</span> NikeClothFactory();<span class="comment">//创建被代理类的对象</span></span><br><span class="line">		ProxyFactory proxy = <span class="keyword">new</span> ProxyFactory(nike);<span class="comment">//创建代理类的对象</span></span><br><span class="line">		proxy.productCloth();</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>输出结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">代理类开始执行，收代理费$1000</span><br><span class="line">Nike工厂生产一批衣服</span><br></pre></td></tr></table></figure>

<h3 id="Proxy类"><a href="#Proxy类" class="headerlink" title="Proxy类"></a>Proxy类</h3><p>Proxy ：专门完成代理的操作类，是所有动态代理类的父类。通过此类为一个或多个接口动态地生成实现类。</p>
<p><img src="http://img.bcoder.top/2017.06.11/7.png" alt="Java反射机制"></p>
<h3 id="动态代理步骤"><a href="#动态代理步骤" class="headerlink" title="动态代理步骤"></a>动态代理步骤</h3><p>1.创建一个实现接口InvocationHandler的类，它必须实现invoke方法，以完成代理的具体操作。</p>
<p><img src="http://img.bcoder.top/2017.06.11/8.png" alt="Java反射机制"></p>
<p>2.创建被代理的类以及接口</p>
<p><img src="http://img.bcoder.top/2017.06.11/9.png" alt="Java反射机制"></p>
<p>3.通过Proxy的静态方法</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">newProxyInstance(ClassLoader loader, Class[] interfaces, InvocationHandler h) 创建一个Subject接口代理</span><br><span class="line">RealSubject target = <span class="keyword">new</span> RealSubject();</span><br><span class="line"><span class="comment">// Create a proxy to wrap the original implementation</span></span><br><span class="line">DebugProxy proxy = <span class="keyword">new</span> DebugProxy(target);</span><br><span class="line"><span class="comment">// Get a reference to the proxy through the Subject interface</span></span><br><span class="line">Subject sub = (Subject) Proxy.newProxyInstance(Subject.class.getClassLoader(),new Class[] &#123; Subject.class &#125;, proxy);</span><br></pre></td></tr></table></figure>
<p>4.通过 Subject代理调用RealSubject实现类的方法</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">String info = sub.say(“Peter<span class="string">", 24);</span></span><br><span class="line"><span class="string">System.out.println(info);</span></span><br></pre></td></tr></table></figure>

<p>demo:一个简单的动态代理的实现</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> reflect;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.InvocationHandler;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Method;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Proxy;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">interface</span> <span class="title">Subject</span></span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">show</span><span class="params">()</span></span>;</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">score</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//被代理类</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Mathe</span> <span class="keyword">implements</span> <span class="title">Subject</span></span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">show</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		System.out.println(<span class="string">"我是数学"</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">score</span><span class="params">()</span></span>&#123;</span><br><span class="line">		System.out.println(<span class="string">"我满分150"</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyInvocationHandler</span> <span class="keyword">implements</span> <span class="title">InvocationHandler</span></span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 实现了接口的被代理类的对象的声明</span></span><br><span class="line">	<span class="keyword">private</span> Object obj;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">// ①给被代理的对象实例化②返回一个代理类的对象</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> Object <span class="title">blind</span><span class="params">(Object obj)</span></span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.obj = obj;</span><br><span class="line">		<span class="keyword">return</span> Proxy.newProxyInstance(obj.getClass().getClassLoader(), </span><br><span class="line">				obj.getClass().getInterfaces(),<span class="keyword">this</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">//当通过代理类的对象发起对被重写的方法的调用时，都会转换为对如下的invoke方法的调用</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> Object <span class="title">invoke</span><span class="params">(Object proxy, Method method, Object[] args)</span></span></span><br><span class="line"><span class="function">			<span class="keyword">throws</span> Throwable </span>&#123;</span><br><span class="line">		<span class="comment">//method方法的返回值时returnVal</span></span><br><span class="line">		Object returnVal = method.invoke(obj, args);</span><br><span class="line">		<span class="keyword">return</span> returnVal;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestProxy</span> </span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		</span><br><span class="line">		<span class="comment">//1.被代理类的对象</span></span><br><span class="line">		Mathe mathe = <span class="keyword">new</span> Mathe();</span><br><span class="line">		</span><br><span class="line">		<span class="comment">//2.创建一个实现了InvacationHandler接口的类的对象</span></span><br><span class="line">		MyInvocationHandler myInvocationHandler = <span class="keyword">new</span> MyInvocationHandler();</span><br><span class="line">		<span class="comment">//3.调用blind()方法，动态的返回一个同样实现了real所在类实现的接口Subject的代理类的对象。</span></span><br><span class="line">		Object object= myInvocationHandler.blind(mathe);</span><br><span class="line">		<span class="comment">//转到对InvacationHandler接口的实现类的invoke()方法的调用</span></span><br><span class="line">		Subject subject = (Subject) object;</span><br><span class="line">		subject.show();</span><br><span class="line">		subject.score();</span><br><span class="line">		</span><br><span class="line">		<span class="comment">//再举一例</span></span><br><span class="line">		NikeClothFactory nike = <span class="keyword">new</span> NikeClothFactory();</span><br><span class="line">		ClothFactory proxyCloth = (ClothFactory)myInvocationHandler.blind(nike);<span class="comment">//proxyCloth即为代理类的对象</span></span><br><span class="line">		proxyCloth.productCloth();</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>输出结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">我是数学</span><br><span class="line">我满分150</span><br><span class="line">Nike工厂生产一批衣服</span><br></pre></td></tr></table></figure>

<h3 id="动态代理与AOP"><a href="#动态代理与AOP" class="headerlink" title="动态代理与AOP"></a>动态代理与AOP</h3><p>前面介绍的Proxy和InvocationHandler，很难看出这种动态代理的优势，下面介绍一种更实用的动态代理机制</p>
<p>之前我们的编码：</p>
<p><img src="http://img.bcoder.top/2017.06.11/10.png" alt="Java反射机制"></p>
<p>改进后：</p>
<p><img src="http://img.bcoder.top/2017.06.11/11.png" alt="Java反射机制"></p>
<p>代码段1、代码段2、代码段3和深色代码段分离开了，但代码段1、2、3又和一个特定的方法A耦合了！最理想的效果是：代码块1、2、3既可以执行方法A，又无须在程序中以硬编码的方式直接调用深色代码的方法.</p>
<p>使用Proxy生成一个动态代理时，往往并不会凭空产生一个动态代理，这样没有太大的意义。通常都是为指定的目标对象生成动态代理<br>这种动态代理在AOP中被称为AOP代理，AOP代理可代替目标对象，AOP代理包含了目标对象的全部方法。但AOP代理中的方法与目标对象的方法存在差异：AOP代理里的方法可以在执行目标方法之前、之后插入一些通用处理</p>
<p><strong>AOP 代理流程图:</strong></p>
<p><img src="http://img.bcoder.top/2017.06.11/12.png" alt="Java反射机制"></p>
<p>demo:AOP的简单实现</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> reflect;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.InvocationHandler;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Method;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Proxy;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">interface</span> <span class="title">Human</span></span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">info</span><span class="params">()</span></span>;</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">fly</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Superman</span> <span class="keyword">implements</span> <span class="title">Human</span></span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">info</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		System.out.println(<span class="string">"我是超人"</span>);</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">fly</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		System.out.println(<span class="string">"我会飞"</span>);</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">HumanUtils</span></span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">method1</span><span class="params">()</span></span>&#123;</span><br><span class="line">		System.out.println(<span class="string">"我是新加入的方法一"</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">method2</span><span class="params">()</span></span>&#123;</span><br><span class="line">		System.out.println(<span class="string">"我是新加入的方法二"</span>);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyInvocation</span> <span class="keyword">implements</span> <span class="title">InvocationHandler</span></span>&#123;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">private</span> Object obj;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setObject</span><span class="params">(Object obj)</span></span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.obj = obj;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> Object <span class="title">invoke</span><span class="params">(Object proxy, Method method, Object[] args)</span></span></span><br><span class="line"><span class="function">			<span class="keyword">throws</span> Throwable </span>&#123;</span><br><span class="line">		HumanUtils utils = <span class="keyword">new</span> HumanUtils();</span><br><span class="line">		utils.method1();</span><br><span class="line">		Object returnVal = method.invoke(obj, args);</span><br><span class="line">		utils.method2();</span><br><span class="line">		<span class="keyword">return</span> returnVal;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyProxy</span></span>&#123;</span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Object <span class="title">getNewInstance</span><span class="params">(Object obj)</span></span>&#123;</span><br><span class="line">		MyInvocation hander = <span class="keyword">new</span> MyInvocation();</span><br><span class="line">		hander.setObject(obj);</span><br><span class="line">		<span class="keyword">return</span> Proxy.newProxyInstance(obj.getClass().getClassLoader(), </span><br><span class="line">				obj.getClass().getInterfaces(), hander);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestAOP</span> </span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		Human human = (Human) MyProxy.getNewInstance(<span class="keyword">new</span> Superman());</span><br><span class="line">		human.info();</span><br><span class="line">		System.out.println(<span class="string">"========================="</span>);</span><br><span class="line">		human.fly();</span><br><span class="line">		System.out.println(<span class="string">"========================="</span>);</span><br><span class="line">		ClothFactory proxyCloth = (ClothFactory) MyProxy.getNewInstance(<span class="keyword">new</span> NikeClothFactory());</span><br><span class="line">		proxyCloth.productCloth();</span><br><span class="line">	</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>输出结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">我是新加入的方法一</span><br><span class="line">我是超人</span><br><span class="line">我是新加入的方法二</span><br><span class="line">&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;</span><br><span class="line">我是新加入的方法一</span><br><span class="line">我会飞</span><br><span class="line">我是新加入的方法二</span><br><span class="line">&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;</span><br><span class="line">我是新加入的方法一</span><br><span class="line">Nike工厂生产一批衣服</span><br><span class="line">我是新加入的方法二</span><br></pre></td></tr></table></figure>
          
            <br>
            
  
    
    

<section class="widget copyright  desktop mobile">
  <div class='content'>
    
      <blockquote>
        
          
            <p>博客内容遵循 署名-非商业性使用-相同方式共享 4.0 国际 (CC BY-NC-SA 4.0) 协议</p>

          
        
          
            <p>本文永久链接是：<a href=https://www.bcoder.top/2017/06/11/Java%E5%8F%8D%E5%B0%84%E6%9C%BA%E5%88%B6/>https://www.bcoder.top/2017/06/11/Java%E5%8F%8D%E5%B0%84%E6%9C%BA%E5%88%B6/</a></p>
          
        
      </blockquote>
    
  </div>
</section>

  

  
    
    

<section class="widget qrcode  desktop mobile">
  

  <div class='content article-entry'>
    
      
        <div class='fancybox'><img src='https://cdn.jsdelivr.net/gh/xaoxuu/cdn-assets/qrcode/wiki_volantis.png'
        
          height='64px'
        ></div>
      
    
      
        <div class='fancybox'><img src='https://cdn.jsdelivr.net/gh/xaoxuu/cdn-assets/qrcode/wiki_volantis.png'
        
          height='64px'
        ></div>
      
    
  </div>
</section>

  


          
        </div>
        
          


  <section class='meta' id="footer-meta">
    <div class='new-meta-box'>
      
        
          <div class="new-meta-item date" itemprop="dateUpdated" datetime="2020-01-21T18:44:03+08:00">
  <a class='notlink'>
    <i class="fas fa-edit fa-fw" aria-hidden="true"></i>
    <p>更新于：2020-01-21 18:44:03</p>
  </a>
</div>

        
      
        
          
  
  <div class="new-meta-item meta-tags"><a class="tag" href="/tags/javase/" rel="nofollow"><i class="fas fa-hashtag fa-fw" aria-hidden="true"></i><p>javase</p></a></div> <div class="new-meta-item meta-tags"><a class="tag" href="/tags/AOP/" rel="nofollow"><i class="fas fa-hashtag fa-fw" aria-hidden="true"></i><p>AOP</p></a></div> <div class="new-meta-item meta-tags"><a class="tag" href="/tags/%E5%8F%8D%E5%B0%84/" rel="nofollow"><i class="fas fa-hashtag fa-fw" aria-hidden="true"></i><p>反射</p></a></div> <div class="new-meta-item meta-tags"><a class="tag" href="/tags/%E5%8A%A8%E6%80%81%E4%BB%A3%E7%90%86/" rel="nofollow"><i class="fas fa-hashtag fa-fw" aria-hidden="true"></i><p>动态代理</p></a></div> <div class="new-meta-item meta-tags"><a class="tag" href="/tags/javase-%E9%AB%98%E7%BA%A7%E7%89%B9%E6%80%A7/" rel="nofollow"><i class="fas fa-hashtag fa-fw" aria-hidden="true"></i><p>javase 高级特性</p></a></div>


        
      
        
          

        
      
        
          
  <div class="new-meta-item share -mob-share-list">
  <div class="-mob-share-list share-body">
    
      
        <a class="-mob-share-qq" title="" rel="external nofollow noopener noreferrer"
          
          href="http://connect.qq.com/widget/shareqq/index.html?url=https://www.bcoder.top/2017/06/11/Java%E5%8F%8D%E5%B0%84%E6%9C%BA%E5%88%B6/&title=Java反射机制 - zln's blog&summary=Java 反射概述 Reflection（反射）是被视为动态语言的关键，反射机制允许程序在执行期借助于Reflection API取得任何类的内部信息，并能直接操作任意对象的内部属性及方法"
          
          >
          
            <img src="https://cdn.jsdelivr.net/gh/xaoxuu/cdn-assets/logo/128/qq.png">
          
        </a>
      
    
      
        <a class="-mob-share-qzone" title="" rel="external nofollow noopener noreferrer"
          
          href="https://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?url=https://www.bcoder.top/2017/06/11/Java%E5%8F%8D%E5%B0%84%E6%9C%BA%E5%88%B6/&title=Java反射机制 - zln's blog&summary=Java 反射概述 Reflection（反射）是被视为动态语言的关键，反射机制允许程序在执行期借助于Reflection API取得任何类的内部信息，并能直接操作任意对象的内部属性及方法"
          
          >
          
            <img src="https://cdn.jsdelivr.net/gh/xaoxuu/cdn-assets/logo/128/qzone.png">
          
        </a>
      
    
      
        <a class="-mob-share-weibo" title="" rel="external nofollow noopener noreferrer"
          
          href="http://service.weibo.com/share/share.php?url=https://www.bcoder.top/2017/06/11/Java%E5%8F%8D%E5%B0%84%E6%9C%BA%E5%88%B6/&title=Java反射机制 - zln's blog&summary=Java 反射概述 Reflection（反射）是被视为动态语言的关键，反射机制允许程序在执行期借助于Reflection API取得任何类的内部信息，并能直接操作任意对象的内部属性及方法"
          
          >
          
            <img src="https://cdn.jsdelivr.net/gh/xaoxuu/cdn-assets/logo/128/weibo.png">
          
        </a>
      
    
  </div>
</div>



        
      
    </div>
  </section>


        
        
          <div class="prev-next">
            
              <a class='prev' href='/2017/06/23/%E6%BC%AB%E7%94%BB%EF%BC%9A%E4%BB%80%E4%B9%88%E6%98%AF%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92%EF%BC%9F/'>
                <p class='title'><i class="fas fa-chevron-left" aria-hidden="true"></i>漫画:什么是动态规划？</p>
                <p class='content'>









** 题目： **
有一座高度是10级台阶的楼梯，从下往上走，每跨一步只能向上1级或者2级台阶。要求用程序来求出一共有多少种走法。
比如，每次走1级台阶，一共走10步，这是其...</p>
              </a>
            
            
              <a class='next' href='/2017/06/10/Redis-%E5%AD%A6%E4%B9%A0%E6%80%BB%E7%BB%93/'>
                <p class='title'>Redis 学习总结<i class="fas fa-chevron-right" aria-hidden="true"></i></p>
                <p class='content'>redis介绍什么是NoSQLNoSQL，泛指非关系型的数据库，NoSQL即Not-Only SQL，它可以作为关系型数据库的良好补充。随着互联网web2.0网站的兴起，非关系型的数据库现在成了...</p>
              </a>
            
          </div>
        
      </section>
    </article>
  

  
    <!-- 显示推荐文章和评论 -->



  <article class="post white-box comments shadow">
    <section class="article typo">
      <p ct><i class='fas fa-comments'></i> 评论</p>
      
      
      
      
      
        <section id="comments">
          <div id="valine_container" class="valine_thread">
            <i class="fas fa-spinner fa-spin fa-fw"></i>
          </div>
        </section>
      
    </section>
  </article>


  




<!-- 根据页面mathjax变量决定是否加载MathJax数学公式js -->



  <script>
    window.subData = {
      title: 'Java反射机制',
      tools: true
    }
  </script>


</div>
<aside class='l_side'>
  
  

  
    
    


  <section class="widget toc-wrapper shadow desktop mobile">
    
  <header>
    
      <i class="fas fa-list fa-fw" aria-hidden="true"></i><span class='name'>本文目录</span>
    
  </header>


    <div class='content'>
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Java-反射概述"><span class="toc-number">1.</span> <span class="toc-text">Java 反射概述</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Class-类"><span class="toc-number">2.</span> <span class="toc-text">Class 类</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Class类概述"><span class="toc-number">2.1.</span> <span class="toc-text">Class类概述</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Class类的常用方法"><span class="toc-number">2.2.</span> <span class="toc-text">Class类的常用方法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#实例化Class类对象-四种方法"><span class="toc-number">2.3.</span> <span class="toc-text">实例化Class类对象(四种方法)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#类加载器"><span class="toc-number">2.4.</span> <span class="toc-text">类加载器</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#类的加载过程"><span class="toc-number">2.4.1.</span> <span class="toc-text">类的加载过程</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#ClassLoader-流程"><span class="toc-number">2.4.2.</span> <span class="toc-text">ClassLoader 流程</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#ClassLoader-使用"><span class="toc-number">2.4.3.</span> <span class="toc-text">ClassLoader 使用</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#创建类对象并获取类的完整结构"><span class="toc-number">3.</span> <span class="toc-text">创建类对象并获取类的完整结构</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#创建类的对象"><span class="toc-number">3.1.</span> <span class="toc-text">创建类的对象</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#通过反射调用类的结构"><span class="toc-number">4.</span> <span class="toc-text">通过反射调用类的结构</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#通过反射调用类中获取全部的特性"><span class="toc-number">4.1.</span> <span class="toc-text">通过反射调用类中获取全部的特性</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#通过反射调用类中的指定方法、指定属性"><span class="toc-number">4.2.</span> <span class="toc-text">通过反射调用类中的指定方法、指定属性</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#调用指定方法"><span class="toc-number">4.2.1.</span> <span class="toc-text">调用指定方法</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#调用指定属性"><span class="toc-number">4.2.2.</span> <span class="toc-text">调用指定属性</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#反射应用：Java动态代理"><span class="toc-number">5.</span> <span class="toc-text">反射应用：Java动态代理</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Proxy类"><span class="toc-number">5.1.</span> <span class="toc-text">Proxy类</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#动态代理步骤"><span class="toc-number">5.2.</span> <span class="toc-text">动态代理步骤</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#动态代理与AOP"><span class="toc-number">5.3.</span> <span class="toc-text">动态代理与AOP</span></a></li></ol></li></ol>
    </div>
  </section>


  


</aside>


  
  <footer class="clearfix">
    <br><br>
    
      
        <br>
        <div class="social-wrapper">
          
            
              <a href="https://www.bcoder.top"
                class="social fas fa-rss flat-btn"
                target="_blank"
                rel="external nofollow noopener noreferrer">
              </a>
            
          
            
              <a href="mailto:me@xaoxuu.com"
                class="social fas fa-envelope flat-btn"
                target="_blank"
                rel="external nofollow noopener noreferrer">
              </a>
            
          
            
              <a href="https://github.com/zlnnjit"
                class="social fab fa-github flat-btn"
                target="_blank"
                rel="external nofollow noopener noreferrer">
              </a>
            
          
            
              <a href="https://music.163.com/#/user/home?id=430673592"
                class="social fas fa-headphones-alt flat-btn"
                target="_blank"
                rel="external nofollow noopener noreferrer">
              </a>
            
          
        </div>
      
    
      
        Use
        <a href="https://bcoder.top/" target="_blank" class="codename">周陆宁</a>
        as theme
        
          , 
          total visits
          <span id="busuanzi_value_site_pv"><i class="fas fa-spinner fa-spin fa-fw" aria-hidden="true"></i></span>
          times
        
      
    
      
        <div class='copyright'>
        <p><a href="https://bocder.top" target="_blank" rel="noopener">Copyright © 2016-2020 zlnnjit</a></p>

        </div>
      
    
  </footer>

<script>setLoadingBarProgress(80);</script>


      <script>setLoadingBarProgress(60);</script>
    </div>
    <a class="s-top fas fa-arrow-up fa-fw" href='javascript:void(0)'></a>
  </div>
  
<script src="https://cdn.jsdelivr.net/npm/jquery@3.4/dist/jquery.min.js"></script>


  <script>
    
    var SEARCH_SERVICE = "hexo" || "hexo";
    var ROOT = "/" || "/";
    if (!ROOT.endsWith('/')) ROOT += '/';
  </script>


  <script async src="https://cdn.jsdelivr.net/gh/xaoxuu/cdn-volantis@2/js/instant_page.js" type="module" defer integrity="sha384-OeDn4XE77tdHo8pGtE1apMPmAipjoxUQ++eeJa6EtJCfHlvijigWiJpD7VDPWXV1"></script>



  
<script src="https://cdn.jsdelivr.net/npm/node-waves@0.7.6/dist/waves.min.js"></script>

  <script type="text/javascript">
    $(function() {
      Waves.attach('.flat-btn', ['waves-button']);
      Waves.attach('.float-btn', ['waves-button', 'waves-float']);
      Waves.attach('.float-btn-light', ['waves-button', 'waves-float', 'waves-light']);
      Waves.attach('.flat-box', ['waves-block']);
      Waves.attach('.float-box', ['waves-block', 'waves-float']);
      Waves.attach('.waves-image');
      Waves.init();
    });
  </script>


  <script async src="https://cdn.jsdelivr.net/gh/xaoxuu/cdn-busuanzi@2.3/js/busuanzi.pure.mini.js"></script>



  
  
  
    
<script src="https://cdn.jsdelivr.net/npm/jquery-backstretch@2.1.18/jquery.backstretch.min.js"></script>

    <script type="text/javascript">
      $(function(){
        var imgs=["https://cdn.jsdelivr.net/gh/xaoxuu/cdn-wallpaper/abstract/41F215B9-261F-48B4-80B5-4E86E165259E.jpeg"];
        if ('true' == 'true') {
          function shuffle(arr){
            /*From countercurrent-time*/
            var n = arr.length;
            while(n--) {
              var index = Math.floor(Math.random() * n);
              var temp = arr[index];
              arr[index] = arr[n];
              arr[n] = temp;
            }
          }
          shuffle(imgs);
        }
        if ('.cover') {
          $('.cover').backstretch(
            imgs,
          {
            duration: "20000",
            fade: "1500"
          });
        } else {
          $.backstretch(
            imgs,
          {
            duration: "20000",
            fade: "1500"
          });
        }
      });
    </script>
  



  
    
<script src="https://cdn.jsdelivr.net/npm/aplayer@1.10/dist/APlayer.min.js" async></script>

  
    
<script src="https://cdn.jsdelivr.net/npm/meting@2.0/dist/Meting.min.js" async></script>

  








  
    
<script src="https://cdn.jsdelivr.net/gh/xaoxuu/cdn-volantis@2.2.0/js/valine.js"></script>

  
  <script>
  var GUEST_INFO = ['nick','mail','link'];
  var guest_info = 'nick,mail,link'.split(',').filter(function(item){
    return GUEST_INFO.indexOf(item) > -1
  });
  var notify = 'true' == true;
  var verify = 'true' == true;
  var valine = new Valine();
  valine.init({
    el: '#valine_container',
    notify: notify,
    verify: verify,
    guest_info: guest_info,
    
    appId: "M3YhrSNLSJTxyKwa8hGSGbH7-gzGzoHsz",
    appKey: "RwjMsAULtRweeA4GtaqJGPVu",
    placeholder: "快来评论吧~",
    pageSize:'10',
    avatar:'mp',
    lang:'zh-cn',
    visitor: 'false',
    highlight:'true'
  })
  </script>



  
<script src="/js/app.js"></script>



  
<script src="https://cdn.jsdelivr.net/gh/xaoxuu/cdn-volantis@2.1/js/search.js"></script>



  
<script src="https://cdn.jsdelivr.net/gh/xaoxuu/cdn-volantis@2/js/comment_typing.js"></script>



<!-- 复制 -->

  <script src="https://cdn.jsdelivr.net/npm/clipboard@2/dist/clipboard.min.js"></script>
<script>
  !function (e, t, a) {
    var initCopyCode = function(){
      var copyHtml = '';
      copyHtml += '<button class="btn-copy" data-clipboard-snippet="">';
      copyHtml += '<i class="fas fa-copy"></i><span>COPY</span>';
      copyHtml += '</button>';
      $(".highlight .code pre").before(copyHtml);
      var clipboard = new ClipboardJS('.btn-copy', {
        target: function(trigger) {
          return trigger.nextElementSibling;
        }
      });
      clipboard.on('success', function(e) {
        let $btn = $(e.trigger);
        $btn.addClass('copyed');
        let $icon = $($btn.find('i'));
        $icon.removeClass('fa-copy');
        $icon.addClass('fa-clipboard-check');
        let $span = $($btn.find('span'));
        $span[0].innerText = 'COPYED';
      });
      clipboard.on('error', function(e) {
        e.clearSelection();
        let $btn = $(e.trigger);
        $btn.addClass('copy-failed');
        let $icon = $($btn.find('i'));
        $icon.removeClass('fa-copy');
        $icon.addClass('fa-exclamation-triangle');
        let $span = $($btn.find('span'));
        $span[0].innerText = 'COPY FAILED';
      });
    }
    initCopyCode();
  }(window, document);
</script>




<!-- fancybox -->

  <script src="https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js"></script>
<script>
  let LAZY_LOAD_IMAGE = "";
  $(".article-entry").find("div.fancybox").find("img").each(function () {
      var element = document.createElement("a");
      $(element).attr("data-fancybox", "gallery");
      $(element).attr("href", $(this).attr("src"));
      /* 图片采用懒加载处理时,
       * 一般图片标签内会有个属性名来存放图片的真实地址，比如 data-original,
       * 那么此处将原本的属性名src替换为对应属性名data-original,
       * 修改如下
       */
       if (LAZY_LOAD_IMAGE) {
         $(element).attr("href", $(this).attr("data-original"));
       }
      $(this).wrap(element);
  });
</script>






  <script>setLoadingBarProgress(100);</script>
</body>
</html>
